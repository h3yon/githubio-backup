<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>[ìŠ¤í”„ë§ ì¸ ì•¡ì…˜5] Chapter4~6 ë‚´ìš© ì •ë¦¬ - ê°œêµ¬ë¦¬ì˜ ê¹ƒí—ˆë¸Œ ë¸”ë¡œê·¸</title>
<meta name="description" content="Chapter4 ìŠ¤í”„ë§ ì‹œíë¦¬í‹°">


  <meta name="author" content="ğŸ¸ SW developer">
  
  <meta property="article:author" content="ğŸ¸ SW developer">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="ê°œêµ¬ë¦¬ì˜ ê¹ƒí—ˆë¸Œ ë¸”ë¡œê·¸">
<meta property="og:title" content="[ìŠ¤í”„ë§ ì¸ ì•¡ì…˜5] Chapter4~6 ë‚´ìš© ì •ë¦¬">
<meta property="og:url" content="http://localhost:4000/spring/TIL-sia2/">


  <meta property="og:description" content="Chapter4 ìŠ¤í”„ë§ ì‹œíë¦¬í‹°">







  <meta property="article:published_time" content="2021-10-18T00:00:00+09:00">





  

  


<link rel="canonical" href="http://localhost:4000/spring/TIL-sia2/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "h3yon Developer",
      "url": "http://localhost:4000/"
    
  }
</script>







<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="ê°œêµ¬ë¦¬ì˜ ê¹ƒí—ˆë¸Œ ë¸”ë¡œê·¸ Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->
<link rel="apple-touch-icon" sizes="180x180" href="/assets/favicon/apple-touch-icon.png" />
<link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon/favicon-32x32.png" />
<link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon/favicon-16x16.png" />
<link rel="manifest" href="/assets/favicon/site.webmanifest" />
<link rel="mask-icon" href="/assets/favicon/safari-pinned-tab.svg" color="#5bbad5" />
<meta name="msapplication-TileColor" content="#da532c" />
<meta name="theme-color" content="#ffffff" />

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          ê°œêµ¬ë¦¬ì˜ ê¹ƒí—ˆë¸Œ ë¸”ë¡œê·¸
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="https://h3yon.github.io/">ë¸”ë¡œê·¸ ë°©ë¬¸í•˜ê¸°</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/Java/">Java</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/">Categories</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/">Tags</a>
            </li><li class="masthead__menu-item">
              <a href="/about/">About</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person" class="h-card">

  
    <div class="author__avatar">
      <a href="http://localhost:4000/">
        <img src="/assets/images/profile.jpeg" alt="ğŸ¸ SW developer" itemprop="image" class="u-photo">
      </a>
    </div>
  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="http://localhost:4000/" itemprop="url">ğŸ¸ SW developer</a>
    </h3>
    
      <div class="author__bio p-note" itemprop="description">
        <p>ğŸŒ¿ ì„±ì¥í•˜ëŠ” ê°œêµ¬ë¦¬ h3yonì…ë‹ˆë‹¤!</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name" class="p-locality">South Korea</span>
        </li>
      

      
        
          
            <li><a href="khykhy1006@gmail.com" rel="nofollow noopener noreferrer me"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span></a></li>
          
        
          
            <li><a href="https://h3yon.shop" rel="nofollow noopener noreferrer me"><i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label">Website</span></a></li>
          
        
          
            <li><a href="https://github.com/h3yon" rel="nofollow noopener noreferrer me"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>
  
  </div>



  <article class="page h-entry" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="[ìŠ¤í”„ë§ ì¸ ì•¡ì…˜5] Chapter4~6 ë‚´ìš© ì •ë¦¬">
    <meta itemprop="description" content="Chapter4 ìŠ¤í”„ë§ ì‹œíë¦¬í‹°">
    <meta itemprop="datePublished" content="2021-10-18T00:00:00+09:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title p-name" itemprop="headline">
            <a href="http://localhost:4000/spring/TIL-sia2/" class="u-url" itemprop="url">[ìŠ¤í”„ë§ ì¸ ì•¡ì…˜5] Chapter4~6 ë‚´ìš© ì •ë¦¬
</a>
          </h1>
          <p class="page__date"><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> 
            Updated: 
            <time datetime="2021-10-18T00:00:00+09:00">October 18, 2021</time>
          </p>
          <!-- 

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          6 minute read
        
      </span>
    
  </p>

 -->
        </header>
      

      <section class="page__content e-content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On this page</h4></header>
              <ul class="toc__menu"><li><a href="#chapter4-ìŠ¤í”„ë§-ì‹œíë¦¬í‹°">Chapter4 ìŠ¤í”„ë§ ì‹œíë¦¬í‹°</a><ul><li><a href="#421ì¸ë©”ëª¨ë¦¬-ì‚¬ìš©ì-ìŠ¤í† ì–´">4.2.1ì¸ë©”ëª¨ë¦¬ ì‚¬ìš©ì ìŠ¤í† ì–´</a></li><li><a href="#422-jdbc-ê¸°ë°˜ì˜-ì‚¬ìš©ì-ìŠ¤í† ì–´">4.2.2 JDBC ê¸°ë°˜ì˜ ì‚¬ìš©ì ìŠ¤í† ì–´</a></li><li><a href="#423-ldap-ê¸°ë°˜-ì‚¬ìš©ì-ìŠ¤í† ì–´">4.2.3 LDAP ê¸°ë°˜ ì‚¬ìš©ì ìŠ¤í† ì–´</a></li><li><a href="#424-ì‚¬ìš©ì-ì¸ì¦ì˜-ì»¤ìŠ¤í„°ë§ˆì´ì§•">4.2.4 ì‚¬ìš©ì ì¸ì¦ì˜ ì»¤ìŠ¤í„°ë§ˆì´ì§•</a></li><li><a href="#432-ì»¤ìŠ¤í…€-ë¡œê·¸ì¸-í˜ì´ì§€">4.3.2 ì»¤ìŠ¤í…€ ë¡œê·¸ì¸ í˜ì´ì§€</a></li><li><a href="#44-ì‚¬ìš©ì-ì¸ì§€í•˜ê¸°">4.4 ì‚¬ìš©ì ì¸ì§€í•˜ê¸°</a></li></ul></li><li><a href="#chapter5-êµ¬ì„±-ì†ì„±-ì‚¬ìš©í•˜ê¸°">Chapter5 êµ¬ì„± ì†ì„± ì‚¬ìš©í•˜ê¸°</a><ul><li><a href="#51-ìë™-êµ¬ì„±-ì„¸ë¶€-ì¡°ì •ì¶”ìƒí™”ì˜-ê°œë…ê³¼-yml">5.1 ìë™ êµ¬ì„± ì„¸ë¶€ ì¡°ì •(ì¶”ìƒí™”ì˜ ê°œë…ê³¼ yml)</a></li><li><a href="#52-í˜ì´ì§•--êµ¬ì„±-ì†ì„±-ìƒì„±í•˜ê¸°">5.2 í˜ì´ì§• &amp; êµ¬ì„± ì†ì„± ìƒì„±í•˜ê¸°</a></li></ul></li></ul>

            </nav>
          </aside>
        
        <h2 id="chapter4-ìŠ¤í”„ë§-ì‹œíë¦¬í‹°">Chapter4 ìŠ¤í”„ë§ ì‹œíë¦¬í‹°</h2>

<p>ì‚¬ìš© ì˜ˆì‹œë¡œ ì•Œì•„ë³´ê¸°</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@EnableWebSecurity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SecurityConfig</span> <span class="kd">extends</span> <span class="nc">WebSecurityConfigurerAdapter</span> <span class="o">{</span>


	<span class="c1">//HTTP ë³´ì•ˆ êµ¬ì„±</span>
    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">configure</span><span class="o">(</span><span class="nc">HttpSecurity</span> <span class="n">http</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span><span class="o">{</span> 
        <span class="n">http</span>
                <span class="o">.</span><span class="na">authorizeRequests</span><span class="o">()</span>										<span class="c1">// ExpressionInterceptUrlRegistry ê°ì²´ ë°˜í™˜</span>
                <span class="o">.</span><span class="na">antMatchers</span><span class="o">(</span><span class="s">"/design"</span><span class="o">,</span> <span class="s">"/orders"</span><span class="o">)</span> 					<span class="c1">// ì´ ë¶€ë¶„ì€</span>
                <span class="o">.</span><span class="na">access</span><span class="o">(</span><span class="s">"hasRole('ROLE_USER')"</span><span class="o">)</span> 					<span class="c1">// ì¸ê°€ ê³¼ì •</span>
                <span class="o">.</span><span class="na">antMatchers</span><span class="o">(</span><span class="s">"/"</span><span class="o">,</span> <span class="s">"/**"</span><span class="o">).</span><span class="na">access</span><span class="o">(</span><span class="s">"permitAll"</span><span class="o">)</span> 		<span class="c1">// ì´ ë¶€ë¶„ì€ ëˆ„êµ¬ë‚˜ ì ‘ì† ê°€ëŠ¥</span>
                <span class="o">.</span><span class="na">and</span><span class="o">()</span>
                <span class="o">.</span><span class="na">httpBasic</span><span class="o">();</span>
    <span class="o">}</span>

	<span class="c1">//ì‚¬ìš©ì ì¸ì¦ ì •ë³´ êµ¬ì„±</span>
    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">configure</span><span class="o">(</span><span class="nc">AuthenticationManager</span> <span class="n">auth</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span><span class="o">{</span>
        <span class="n">auth</span><span class="o">.</span><span class="na">inMemoryAuthentication</span><span class="o">()</span>
				<span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>

<p>ì—¬ëŸ¬ê°€ì§€ ì‚¬ìš©ì ìŠ¤í† ì–´ êµ¬ì„± ë°©ë²• 4ê°€ì§€</p>

<ul>
  <li>ì¸ë©”ëª¨ë¦¬ ì‚¬ìš©ì ìŠ¤í† ì–´</li>
  <li>JDBC ê¸°ë°˜ ì‚¬ìš©ì ìŠ¤í† ì–´</li>
  <li>LDAP ê¸°ë°˜ ì‚¬ìš©ì ìŠ¤í† ì–´</li>
  <li>ì»¤ìŠ¤í…€ ì‚¬ìš©ì ëª…ì„¸ ì„œë¹„ìŠ¤</li>
</ul>

<h3 id="421ì¸ë©”ëª¨ë¦¬-ì‚¬ìš©ì-ìŠ¤í† ì–´">4.2.1ì¸ë©”ëª¨ë¦¬ ì‚¬ìš©ì ìŠ¤í† ì–´</h3>

<p>ë©”ëª¨ë¦¬ = ì‚¬ìš©ì ì •ë³´ë¥¼ ìœ ì§€, ê´€ë¦¬í•  ìˆ˜ ìˆëŠ” ê³³ ì¤‘ í•˜ë‚˜</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@EnableWebSecurity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SecurityConfig</span> <span class="kd">extends</span> <span class="nc">WebSecurityConfigurerAdapter</span> <span class="o">{</span>


	<span class="o">...</span>


    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">configure</span><span class="o">(</span><span class="nc">AuthenticationManager</span> <span class="n">auth</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span><span class="o">{</span>
        <span class="n">auth</span><span class="o">.</span><span class="na">inMemoryAuthentication</span><span class="o">()</span>
                <span class="o">.</span><span class="na">withUser</span><span class="o">(</span><span class="s">"user1"</span><span class="o">)</span>
                <span class="o">.</span><span class="na">password</span><span class="o">(</span><span class="s">"{noop}password1"</span><span class="o">)</span> 		<span class="c1">//{noop} ë¹„ë°€ë²ˆí˜¸ ì•”í˜¸í™”X</span>
                <span class="o">.</span><span class="na">authorities</span><span class="o">(</span><span class="s">"ROLE_USER"</span><span class="o">)</span>
                <span class="o">.</span><span class="na">and</span><span class="o">()</span>
                <span class="o">.</span><span class="na">withUser</span><span class="o">(</span><span class="s">"user2"</span><span class="o">)</span>
                <span class="o">.</span><span class="na">password</span><span class="o">(</span><span class="s">"{noop}password2"</span><span class="o">)</span>
                <span class="o">.</span><span class="na">authorities</span><span class="o">(</span><span class="s">"ROLE_USER"</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>withUserë¡œ ì‚¬ìš©ì êµ¬ì„± ì‹œì‘ -&gt; ì´ë¦„, ë¹„ë°€ë²ˆí˜¸, ê¶Œí•œì„ ì¸ìë¡œ ì „ë‹¬í•œë‹¤.
ex) withUser(â€œname).password(â€œpwâ€).authorities(â€œROLE_USERâ€)</p>
<ul>
  <li>authorities(â€œROLE_USERâ€) ëŒ€ì‹  .roles(â€œUSERâ€)ë¥¼ ì‚¬ìš©í•´ë„ O</li>
  <li>password() ë©”ì„œë“œ í˜¸ì¶œí•˜ì—¬ ì•”í˜¸í™” í•˜ì§€ ì•Šìœ¼ë©´ HTTP 403/500 ì—ëŸ¬(ì ‘ê·¼ ê±°ë¶€/Internal Server Error)</li>
</ul>

<h3 id="422-jdbc-ê¸°ë°˜ì˜-ì‚¬ìš©ì-ìŠ¤í† ì–´">4.2.2 JDBC ê¸°ë°˜ì˜ ì‚¬ìš©ì ìŠ¤í† ì–´</h3>
<p>ì‚¬ìš©ì ì •ë³´ëŠ” ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ë¡œ ìœ ì§€, ê´€ë¦¬ë˜ëŠ” ê²½ìš°ê°€ ë§ì•„ JDBC ê¸°ë°˜ ì‚¬ìš©ì ìŠ¤í† ì–´ê°€ ì í•©</p>

<p>ì´ ë¶€ë¶„ë„ ë§ˆì°¬ê°€ì§€ë¡œ PasswordEncoderë¥¼ ì‚¬ìš©í•´ì„œ ë¹„ë°€ë²ˆí˜¸ ì•”í˜¸í™” í•„ìš”</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@EnableWebSecurity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SecurityConfig</span> <span class="kd">extends</span> <span class="nc">WebSecurityConfigurerAdapter</span> <span class="o">{</span>


	<span class="o">...</span>


    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">configure</span><span class="o">(</span><span class="nc">AuthenticationManager</span> <span class="n">auth</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span><span class="o">{</span>
         <span class="n">auth</span>
            <span class="o">.</span><span class="na">jdbcAuthentication</span><span class="o">()</span>
            <span class="o">.</span><span class="na">dataSource</span><span class="o">(</span><span class="n">dataSource</span><span class="o">)</span>
            <span class="c1">// ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ì™€ ë‹¤ë¥¸ ë°ì´í„°ë² ì´ìŠ¤(í…Œì´ë¸”ì´ë‚˜ ì—´ì˜ ì´ë¦„ì´ ë‹¤ë¥¼ ë•Œ)ë¥¼ ì‚¬ìš©í•  ê²½ìš°</span>
            <span class="o">.</span><span class="na">usersByUsernameQuery</span><span class="o">(</span><span class="s">"select username, password, enabled, from users where username=?"</span><span class="o">)</span>
            <span class="o">.</span><span class="na">authoritiesByUsernameQuery</span><span class="o">(</span><span class="s">"select username, authority from authorities where username=?"</span><span class="o">)</span>
			<span class="o">.</span><span class="na">passwordEncoder</span><span class="o">(</span><span class="k">new</span> <span class="nc">BCryptPasswordEncoder</span><span class="o">());</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ì˜ ë‚´ë¶€ ì½”ë“œì—ì„œëŠ”</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>DEF_USERS_BY_USERNAME_QUERY = "select username ,password, enabled from users where username = ?"
DEF_AUTHORITIES_BY_USERNAME_QUERY = "select username, authority from authorities where username = ?"
DEF_GROUP_AUTHORITIES_BY_USERNAME_QUERY = "select g.id, g.group_name, ga.authority from authorities g, group_members gm, group_authorities ga where gm.username = ? and g.id = ga.group_id and g.id = gm.group_id";
</code></pre></div></div>

<p>ë¥¼ ì‚¬ìš©í•˜ê³  ìœ„ì— ì½”ë“œì²˜ëŸ¼ custom SQL ì¿¼ë¦¬ë¡œ ëŒ€ì²´í•  ìˆ˜ ìˆë‹¤.</p>

<p>â†’ ì¡°ê±´ì˜ ê²½ìš°, whereì ˆì— ì‚¬ìš©ë˜ëŠ” ë§¤ê°œë³€ìˆ˜ëŠ” í•˜ë‚˜ì´ë©°, usernameì´ì–´ì•¼ í•œë‹¤. ì‚¬ìš©ì ì •ë³´ ì¸ì¦ ì¿¼ë¦¬ì—ì„œ username, password, enabled ì—´ ê°’ì„ ë°˜í™˜í•´ì•¼ í•œë‹¤.</p>

<h3 id="423-ldap-ê¸°ë°˜-ì‚¬ìš©ì-ìŠ¤í† ì–´">4.2.3 LDAP ê¸°ë°˜ ì‚¬ìš©ì ìŠ¤í† ì–´</h3>

<p>LDAP(Lightweight Directory Access Protocol) ê¸°ë°˜ ì¸ì¦ì€ <code class="language-plaintext highlighter-rouge">ldapAuthentication()</code> ë©”ì„œë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@EnableWebSecurity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SecurityConfig</span> <span class="kd">extends</span> <span class="nc">WebSecurityConfigurerAdapter</span> <span class="o">{</span>


	<span class="o">...</span>


    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">configure</span><span class="o">(</span><span class="nc">AuthenticationManager</span> <span class="n">auth</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span><span class="o">{</span>
			<span class="n">auth</span><span class="o">.</span><span class="na">ldapAuthentication</span><span class="o">()</span>
				<span class="c1">// .userSearchBase("ou=people") 					&lt;- ì´ë ‡ê²Œ ê¸°ì¤€ì  ì¿¼ë¦¬ë¥¼ ì§€ì • ê°€ëŠ¥(êµ¬ì„± ë‹¨ìœ„)</span>
    	   	 	<span class="o">.</span><span class="na">userSearchFilter</span><span class="o">(</span><span class="s">"(uid={0})"</span><span class="o">)</span>
        		<span class="o">.</span><span class="na">groupSearchFilter</span><span class="o">(</span><span class="s">"member={0}"</span><span class="o">);</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>LDAPì˜ ê¸°ë³¸ ì¸ì¦ ì „ëµì€ ì‚¬ìš©ìê°€ ì§ì ‘ LDAP ì„œë²„ì—ì„œ ì¸ì¦ë°›ë„ë¡ í•˜ëŠ” ê²ƒ.
ì™¸ì—ë„ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë¹„êµí•˜ëŠ” ë°©ë²•ë„ O
ì…ë ¥ëœ ë¹„ë°€ë²ˆí˜¸ë¥¼ LDAP ë””ë ‰í† ë¦¬ì— ì „ì†¡í•œ í›„, ë¹„ë°€ë²ˆí˜¸ë¥¼ ë¹„ë°€ë²ˆí˜¸ ì†ì„± ê°’ê³¼ ë¹„êµí•˜ë„ë¡ LDAP ì„œë²„ì— ìš”ì²­í•œë‹¤.(ì´ ë¹„êµëŠ” LDAP ì„œë²„ì—ì„œ ìˆ˜í–‰)</p>

<p>â†’ ë¹„êµ ì‹œ passwordCompare() ë©”ì„œë“œ í˜¸ì¶œí•˜ë©´ ëœë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@EnableWebSecurity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SecurityConfig</span> <span class="kd">extends</span> <span class="nc">WebSecurityConfigurerAdapter</span> <span class="o">{</span>


	<span class="o">...</span>


    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">configure</span><span class="o">(</span><span class="nc">AuthenticationManager</span> <span class="n">auth</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span><span class="o">{</span>
			<span class="n">auth</span><span class="o">.</span><span class="na">ldapAuthentication</span><span class="o">()</span>
    	   	 	<span class="o">.</span><span class="na">userSearchFilter</span><span class="o">(</span><span class="s">"(uid={0})"</span><span class="o">)</span>
        		<span class="o">.</span><span class="na">groupSearchFilter</span><span class="o">(</span><span class="s">"member={0}"</span><span class="o">);</span>
				<span class="o">.</span><span class="na">passwordCompare</span><span class="o">()</span> 													<span class="c1">// ë¹„êµí•˜ê³ </span>
				<span class="o">.</span><span class="na">passwordEncoder</span><span class="o">(</span><span class="k">new</span> <span class="nc">BCryptPasswordEncoder</span><span class="o">())</span> 		<span class="c1">//ì•”í˜¸í™”í•˜ê³ </span>
				<span class="o">.</span><span class="na">passwordAttribute</span><span class="o">(</span><span class="s">"userPassword"</span><span class="o">);</span> 							<span class="c1">// password ëŒ€ì‹  userPasswordë¡œ ì§€ì •í•´ë†”ì„œ ê·¸ê±¸ë¡œ ì§„í–‰</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>LDAP ì„œë²„?</p>

<p>ê¸°ë³¸ì ìœ¼ë¡œ localhost:33389.
contextSourceë©”ì„œë“œë¡œ ì„œë²„ ìœ„ì¹˜ êµ¬ì„± ê°€ëŠ¥ â†’ ContextSourceBuilder ë°˜í™˜</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@EnableWebSecurity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SecurityConfig</span> <span class="kd">extends</span> <span class="nc">WebSecurityConfigurerAdapter</span> <span class="o">{</span>


	<span class="o">...</span>


    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">configure</span><span class="o">(</span><span class="nc">AuthenticationManager</span> <span class="n">auth</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span><span class="o">{</span>
		<span class="o">...</span>
        <span class="o">.</span><span class="na">passwordCompare</span><span class="o">()</span>
        <span class="o">.</span><span class="na">passwordEncoder</span><span class="o">(</span><span class="k">new</span> <span class="nc">BCryptPasswordEncoder</span><span class="o">())</span>
        <span class="o">.</span><span class="na">passwordAttribute</span><span class="o">(</span><span class="s">"userPassword"</span><span class="o">);</span>
        <span class="o">.</span><span class="na">contextSource</span><span class="o">()</span>
        <span class="o">.</span><span class="na">root</span><span class="o">(</span><span class="s">"dc=tacocloud,dc=com"</span><span class="o">)</span>			<span class="c1">//urlë„ ê°€ëŠ¥</span>
        <span class="o">.</span><span class="na">ldif</span><span class="o">(</span><span class="s">"classpath:users.ldif"</span><span class="o">)</span>        			<span class="c1">//LDAP ë°ì´í„°ë¥¼ ë‚˜íƒ€ë‚´ëŠ” í‘œì¤€í™”ëœ ë°©ë²•. ìë™ìœ¼ë¡œ users.ldif ë¡œë“œ</span>


	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p>ë¡œê·¸ì¸ì´ ë˜ê²Œ í•˜ë ¤ë©´ ë¯¸ë¦¬ ì •í•´ë‘” ë¹„ë°€ë²ˆí˜¸ë¥¼ ì•”í˜¸í™”í•œ ê²°ê³¼ê°’ì„ ì•Œì•„ë‚¸ í›„</p>

<p>LDIF íŒŒì¼ ì‚¬ìš©ìì˜ passCode ê°’ìœ¼ë¡œ êµì²´í•˜ê³  application ë‹¤ì‹œ ì‹œì‘</p>

<h3 id="424-ì‚¬ìš©ì-ì¸ì¦ì˜-ì»¤ìŠ¤í„°ë§ˆì´ì§•">4.2.4 ì‚¬ìš©ì ì¸ì¦ì˜ ì»¤ìŠ¤í„°ë§ˆì´ì§•</h3>
<p>(ì´ê±´ ì½”ë“œë¡œ ë³´ê¸°)</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="kd">implements</span> <span class="nc">UserDetails</span> <span class="o">{</span>
	<span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>

<p>ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ì˜ UserDetailsë¥¼ êµ¬í˜„í•˜ë©´</p>

<p>getAuthorities() â†’ ë¶€ì—¬ëœ ê¶Œí•œ ì €ì¥í•œ ì»¬ë ‰ì…˜ ë°˜í™˜</p>

<p>ì™¸ì—ë„ is â†’ AccountNonExpired()/NonLocked()/CredentialsNonExpired()/isEnabled() ì¡´ì¬</p>

<ul>
  <li>ë‚´ì¥ëœ UserDetailsService.</li>
</ul>

<p>â†’ Userì—ì„œëŠ” UserDetailsë¥¼ êµ¬í˜„. UserRepositoryì—ì„œëŠ” findByUsername()ì„ ì œê³µí•˜ë¯€ë¡œ UserDetailsService êµ¬í˜„ í´ë˜ìŠ¤ì—ì„œ ì‚¬ìš©í•´ì•¼ í•˜ëŠ” ëª¨ë“  ê²ƒì´ ì¤€ë¹„ëœ ìƒíƒœ</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UserDetailsService</span><span class="o">{</span>
	<span class="nc">UserDetails</span> <span class="nf">loadUserByUsername</span><span class="o">(</span><span class="nc">String</span> <span class="n">username</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">UsernameNotFoundException</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<p>ê·¸ëŸ¼ UserDetailsServiceë¥¼ êµ¬í˜„í•˜ëŠ” í´ë˜ìŠ¤!</p>

<h3 id="432-ì»¤ìŠ¤í…€-ë¡œê·¸ì¸-í˜ì´ì§€">4.3.2 ì»¤ìŠ¤í…€ ë¡œê·¸ì¸ í˜ì´ì§€</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="n">http</span>
            <span class="o">.</span><span class="na">authorizeRequests</span><span class="o">()</span>
            <span class="o">.</span><span class="na">antMatchers</span><span class="o">(</span><span class="s">"/design"</span><span class="o">,</span> <span class="s">"/orders"</span><span class="o">)</span>
            <span class="o">.</span><span class="na">access</span><span class="o">(</span><span class="s">"hasRole('ROLE_USER')"</span><span class="o">)</span>
            <span class="o">.</span><span class="na">antMatchers</span><span class="o">(</span><span class="s">"/"</span><span class="o">,</span> <span class="s">"/**"</span><span class="o">).</span><span class="na">access</span><span class="o">(</span><span class="s">"permitAll"</span><span class="o">)</span>
            <span class="o">.</span><span class="na">and</span><span class="o">()</span>
            <span class="o">.</span><span class="na">formLogin</span><span class="o">()</span>      								<span class="c1">//ì´ ë¶€ë¶„ ì¶”ê°€</span>
            <span class="o">.</span><span class="na">loginPage</span><span class="o">(</span><span class="s">"/login"</span><span class="o">);</span>
			<span class="o">.</span><span class="na">dafaultSuccessUrl</span><span class="o">(</span><span class="s">"/design"</span><span class="o">,</span> <span class="kc">true</span><span class="o">)</span>		<span class="c1">// ë¡œê·¸ì¸ í›„ ì´ë™í•  í˜ì´ì§€</span>
			<span class="o">.</span><span class="na">loginProcessingUrl</span><span class="o">(</span><span class="s">"/authenticate"</span><span class="o">)</span>		<span class="c1">//í•´ë‹¹ ìš”ì²­ìœ¼ë¡œ ë¡œê·¸ì¸ ì²˜ë¦¬	</span>
			<span class="o">.</span><span class="na">usernameParameter</span><span class="o">(</span><span class="s">"user"</span><span class="o">)</span> 				<span class="c1">//í•„ìš”í•  ê²½ìš° ì´ë ‡ê²Œ í•„ë“œ ì´ë¦„ë„ ì„¤ì • ê°€ëŠ¥</span>
</code></pre></div></div>

<p>â†’ WebConfigì—ë„ ë·°ë§Œ ë¿Œë ¤ì£¼ë©´ ë˜ê¸° ë•Œë¬¸ì— /login í˜ì´ì§€ ì¶”ê°€</p>

<p>ë¡œê·¸ì•„ì›ƒí•˜ê¸°</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="n">http</span><span class="o">.</span>
			<span class="o">...</span>
			<span class="o">.</span><span class="na">and</span><span class="o">()</span>
			<span class="o">.</span><span class="na">logout</span><span class="o">()</span>
			<span class="o">.</span><span class="na">logoutSuccessUrl</span><span class="o">(</span><span class="s">"/"</span><span class="o">);</span>	
</code></pre></div></div>

<h3 id="44-ì‚¬ìš©ì-ì¸ì§€í•˜ê¸°">4.4 ì‚¬ìš©ì ì¸ì§€í•˜ê¸°</h3>

<p>ì‚¬ìš©ì ì¸ì§€í•˜ëŠ” ë°©ë²• ì¤‘ ë§ì´ ì‚¬ìš©ë˜ëŠ” ë°©ë²•ì€ ì•„ë˜ì™€ ê°™ë‹¤</p>

<p>Principal ê°ì²´ë¥¼ ì»¨íŠ¸ë¡¤ëŸ¬ ë©”ì„œë“œì— ì£¼ì…
Authentication ê°ì²´ë¥¼ ì»¨íŠ¸ë¡¤ëŸ¬ ë©”ì„œë“œì— ì£¼ì…
SecurityContextHolderë¥¼ ì‚¬ìš©í•´ì„œ ë³´ì•ˆ ì»¨í…ìŠ¤íŠ¸ë¥¼ ì–»ê¸°
@AuthenticationPrincipal ì• ë…¸í…Œì´ì…˜ì„ ë©”ì„œë“œì— ì €ì¥</p>

<p>@AuthenticationPrincipalë¡œ ì‚¬ìš©ì ì¸ì§€</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@PostMapping</span>
<span class="kd">public</span> <span class="nc">String</span> <span class="nf">processOrder</span><span class="o">(</span><span class="nd">@Valid</span> <span class="nc">Order</span> <span class="n">order</span><span class="o">,</span> <span class="o">...</span>
        <span class="o">,</span> <span class="nd">@AuthenticationPrincipal</span> <span class="nc">User</span> <span class="n">user</span> 
<span class="o">)</span> <span class="o">{</span>
    <span class="n">order</span><span class="o">.</span><span class="na">setUser</span><span class="o">(</span><span class="n">user</span><span class="o">);</span>

	<span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<p>ì¥ì : íƒ€ì… ë³€í™˜ì´ í•„ìš”ì—†ê³  Authenticationê³¼ ë™ì¼í•˜ê²Œ ë³´ì•ˆ íŠ¹ì • ì½”ë“œë§Œ ê°€ì§„ë‹¤.</p>

<p>SecurityContextHolderë¡œ í•  ê²½ìš°</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Authentication</span> <span class="n">authentication</span> <span class="o">=</span> <span class="nc">SecurityContextHolder</span><span class="o">.</span><span class="na">getContext</span><span class="o">().</span><span class="na">getAuthentication</span><span class="o">();</span>
<span class="nc">User</span> <span class="n">user</span> <span class="o">=</span> <span class="o">(</span><span class="nc">User</span><span class="o">)</span> <span class="n">authentication</span><span class="o">.</span><span class="na">getPrincipal</span><span class="o">();</span>
</code></pre></div></div>
<p>SecurityContextHolderëŠ” Contextë¥¼ getí•˜ê³  Authenticationì„ getí•œ í›„ Principalì„ getí•´ì„œ Userì— ë‹´ëŠ”ë‹¤.</p>

<h2 id="chapter5-êµ¬ì„±-ì†ì„±-ì‚¬ìš©í•˜ê¸°">Chapter5 êµ¬ì„± ì†ì„± ì‚¬ìš©í•˜ê¸°</h2>

<ul>
  <li>ë¹ˆ ì—°ê²°: ìŠ¤í”„ë§ ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸ì—ì„œ ë¹ˆìœ¼ë¡œ ìƒì„±ë˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ ì»´í¬ë„ŒíŠ¸ ë° ìƒí˜¸ ê°„ì— ì£¼ì…ë˜ëŠ” ë°©ë²•ì„ ì„ ì–¸í•˜ëŠ” êµ¬ì„±</li>
  <li>ì†ì„± ì£¼ì…: ìŠ¤í”„ë§ ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸ì—ì„œ ë¹ˆì˜ ì†ì„±ê°’ì„ ì„¤ì •í•˜ëŠ”êµ¬ì„±
ex) @Bean ì• ë…¸í…Œì´ì…˜ì´ ì§€ì •ëœ ë©”ì„œë“œëŠ” ì‚¬ìš©í•˜ëŠ” ë¹ˆì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•˜ê³  ì†ì„±ê°’ë„ ì„¤ì •í•œë‹¤.</li>
</ul>

<p>DataSource ë©”ì„œë“œë¡œ ì‚¬ìš©í•  ê²½ìš° <code class="language-plaintext highlighter-rouge">EmbeddedDatabaseType</code>ìœ¼ë¡œ Type(h2)ì„ ì •í•œ í›„ SQLì´ ì‹¤í–‰ë˜ì–´ DBì— ì ìš©í•´ë„ ëœë‹¤.</p>

<p>ê·¸ëŸ¬ë‚˜ ìŠ¤í”„ë§ë¶€íŠ¸ë¥¼ ì‚¬ìš©ì¤‘ì¼ ë•ŒëŠ” ìë™-êµ¬ì„±ì´ DataSource ë¹ˆì„ êµ¬ì„±í•´ì£¼ë¯€ë¡œ dataSource()ë©”ì„œë“œê°€ í•„ìš”ì—†ë‹¤.</p>

<p>H2 ì˜ì¡´ì„± ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ classpathì—ì„œ ì°¾ì•„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤ë©´ ë¹ˆì„ ìë™ìœ¼ë¡œ ì°¾ì•„ ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸ì— ìƒì„±í•˜ê³ 
schema.sql, data.sqlì„ ì‹¤í–‰í•˜ì—¬ DBì— ì ìš©ì‹œí‚¨ë‹¤.
ì–´ì©” ë•Œ(ì´ë¦„ì„ ë‹¤ë¥´ê²Œ ì§€ì •í•˜ê³  ì‹¶ê±°ë‚˜ 3ê°œ ì´ìƒì„ ì§€ì •í•´ì•¼ í•  ë•Œ)ì—ëŠ” êµ¬ì„± ì†ì„±ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</p>

<h3 id="51-ìë™-êµ¬ì„±-ì„¸ë¶€-ì¡°ì •ì¶”ìƒí™”ì˜-ê°œë…ê³¼-yml">5.1 ìë™ êµ¬ì„± ì„¸ë¶€ ì¡°ì •(ì¶”ìƒí™”ì˜ ê°œë…ê³¼ yml)</h3>

<p>ì¶”ìƒí™”ëŠ” êµ¬ì„± ê°€ëŠ¥í•œ ëª¨ë“  ì†ì„±ì„ í•œ ê³³ì—ì„œ ê´€ë¦¬í•˜ëŠ” ê°œë….
ì¶”ìƒí™”í•¨ìœ¼ë¡œì¨ ë¹ˆì´ ìŠ¤í”„ë§ ìì²´ì—ì„œ í•´ë‹¹ ì†ì„±ì„ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•´ì¤€ë‹¤.</p>

<p>ì•„ë˜ ì†ì„± ê·¼ì›ìœ¼ë¡œë¶€í„° ì›ì²œ ì†ì„±ì„ ê°€ì ¸ì˜¨ë‹¤.</p>

<ul>
  <li>JVM ì‹œìŠ¤í…œ ì†ì„±</li>
  <li>ìš´ì˜ì²´ì œì˜ í™˜ê²½ ë³€ìˆ˜</li>
  <li>ëª…ë ¹í–‰ ì¸ì</li>
  <li>ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì†ì„± êµ¬ì„± íŒŒì¼</li>
</ul>

<p>ë˜, YML íŒŒì¼ì—ì„œ ì•„ë˜ì²˜ëŸ¼ ì§„í–‰í•´ë†“ìœ¼ë©´,
í†°ìº£ì˜ JDBC ì»¤ë„¥ì…˜ í’€ì„ classpathì—ì„œ ìë™ìœ¼ë¡œ ì°¾ì„ ìˆ˜ ìˆë‹¤ë©´ DataSource ë¹ˆì´ ê·¸ê±¸ ì‚¬ìš©í•œë‹¤.
ê·¸ë ‡ì§€ ì•Šë‹¤ë©´ ë‹¤ë¥¸ ì»¤ë„¥ì…˜ í’€ì„ classpathì—ì„œ ì°¾ì•„ ì‚¬ìš©í•œë‹¤</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>spring:
  datasource:
    url: jdbc:mysql://localhost/tacocloud
    username: tacodb
    password: tacopassword


	schema:
		- ë‚´ê°€ ì›í•˜ëŠ” ìŠ¤í‚¤ë§ˆ ì´ë¦„.sql
	data:
		- ingredients.sql
</code></pre></div></div>

<p>ì›í•˜ëŠ” ê²½ìš° ì´ë ‡ê²Œ schema, dataë„ ì‚¬ìš© ê°€ëŠ¥í•˜ë‹¤.
ì´ëŸ° ëª…ì‹œì ì¸ ë°ì´í„° ì†ŒìŠ¤ êµ¬ì„± ëŒ€ì‹  JNDI(Java Naming and Directory Interface)ì— êµ¬ì„±í•˜ëŠ” ê²ƒì„ ì›í•  ìˆ˜ë„ ìˆë‹¤.
â†’ ì´ê±¸ í•˜ë©´ ë‹¤ë¥¸ ë°ì´í„° ì†ŒìŠ¤ êµ¬ì„± ì†ì„±ì€ ë¬´ì‹œëœë‹¤.</p>

<p>í•´ë‹¹ yml íŒŒì¼ì—ì„œ HTTPSë¥¼ í™œì„±í™”í•˜ê¸° ìœ„í•´ server: ssl: key-store/key-store-password/key-password ë„ ì‚¬ìš© ê°€ëŠ¥í•˜ë‹¤.</p>

<p>ë¡œê¹…í•˜ëŠ” ë°©ë²•ì˜ ê²½ìš°, logback.xml íŒŒì¼ì„ ì‚¬ìš©í•  ìˆ˜ë„ ìˆì§€ë§Œ,
application.ymlì— logging í•­ëª©ì„ ì§€ì •í•  ìˆ˜ ìˆë‹¤.
(ê¸°ë³¸ ë¡œê·¸ íŒŒì¼ 10MB)</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>logging:
	path: /var/logs/
	file: TacoLogs.log
	level:
		root: WARN
		org.springframework.security: DEBUG
</code></pre></div></div>

<p>ymlíŒŒì¼ì—ì„œ ë‹¤ë¥¸ ì†ì„±ì˜ ê°’ë„ ê°€ì ¸ì˜¬ ìˆ˜ ìˆë‹¤.</p>

<p>ex) greeting.welcome: ${spring.application.name}</p>

<h3 id="52-í˜ì´ì§•--êµ¬ì„±-ì†ì„±-ìƒì„±í•˜ê¸°">5.2 í˜ì´ì§• &amp; êµ¬ì„± ì†ì„± ìƒì„±í•˜ê¸°</h3>

<p>í˜ì´ì§•</p>

<p>Pagingì´ ì–´ë–»ê²Œ ë˜ëŠ”ì§€ ë³¼ ìˆ˜ ìˆë‹¤.</p>

<p>ìŠ¤í”„ë§ ë°ì´í„°ì˜ Pageable ì¸í„°í˜ì´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ë©´ í˜ì´ì§€ ë²ˆí˜¸ì™€ í¬ê¸°ë¡œ ê²°ê³¼ì˜ ì¼ë¶€ë¶„ì„ ì„ íƒí•  ìˆ˜ ìˆë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@GetMapping</span>
<span class="kd">public</span> <span class="nc">String</span> <span class="nf">ordersForUser</span><span class="o">(</span><span class="nd">@AuthenticationPrincipal</span> <span class="nc">User</span> <span class="n">user</span><span class="o">,</span> <span class="nc">Model</span> <span class="n">model</span><span class="o">){</span>
    <span class="nc">Pageable</span> <span class="n">pageable</span> <span class="o">=</span> <span class="nc">PageRequest</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">20</span><span class="o">);</span>
    <span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">"orders"</span><span class="o">,</span> <span class="n">orderRepo</span><span class="o">.</span><span class="na">findByUserOrderByPlacedAtDesc</span><span class="o">(</span><span class="n">user</span><span class="o">,</span> <span class="n">pageable</span><span class="o">));</span>
    <span class="k">return</span> <span class="s">"orderList"</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<p>ê·¼ë° ì´ë ‡ê²Œ 20ìœ¼ë¡œ í•˜ë“œì½”ë”©í•˜ë©´ ì¢‹ì§€ ì•Šì•„ì„œ
ì•„ë˜ì²˜ëŸ¼ ì½”ë“œê°€ ë³€ê²½ëœë‹¤. (ê¸°ë³¸ê°’ = 20)</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@ConfigurationProperties</span><span class="o">(</span><span class="n">prefix</span> <span class="o">=</span> <span class="s">"taco.orders"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">OrderController</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">pageSize</span> <span class="o">=</span> <span class="mi">20</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setPageSize</span><span class="o">(</span><span class="kt">int</span> <span class="n">pageSize</span><span class="o">){</span><span class="k">this</span><span class="o">.</span><span class="na">pageSize</span> <span class="o">=</span> <span class="n">pageSize</span><span class="o">;}</span>
	<span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>

<p>ë³€ê²½í•˜ê³  ì‹¶ì„ ë•Œì—” ì•„ë˜ì²˜ëŸ¼ ymlì—ì„œ ë³€ê²½í•˜ë©´ ëœë‹¤.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>taco:
  orders:
    pageSize:10
</code></pre></div></div>

<p>@ConfigurationProperties</p>

<p>êµ¬ì„± ì†ì„±ì˜ ì˜¬ë°”ë¥¸ ì£¼ì…ì„ ì§€ì›í•˜ê¸° ìœ„í•´ @ConfigurationProperties ì–´ë…¸í…Œì´ì…˜ì„ ì§€ì›í•œë‹¤.
ì´ ì–´ë…¸í…Œì´ì…˜ì€ êµ¬ì„± ë°ì´í„°ì˜ í™€ë”ë¡œ ì‚¬ìš©ë˜ëŠ” ë¹ˆì— ì§€ì •ë˜ëŠ” ê²½ìš°ê°€ ë§ê³ , ì´ë ‡ê²Œ ì‚¬ìš©í•˜ë©´
ì»¨íŠ¸ë¡¤ëŸ¬ì™€ ê·¸ ì™¸ í´ë˜ìŠ¤ ì™¸ë¶€ì— êµ¬ì„± ê´€ë ¨ ì •ë³´ë¥¼ ë”°ë¡œ ìœ ì§€í•  ìˆ˜ ìˆë‹¤.
ì—¬ëŸ¬ ë¹ˆì— ê³µí†µì ì¸ êµ¬ì„± ì†ì„±ì„ ì‰½ê²Œ ê³µìœ í•  ìˆ˜ ìˆë‹¤.</p>

<p>ê·¸ ì˜ˆì œë¥¼ í•œë²ˆ ë´ë³´ì!</p>

<p>ë¨¼ì € ì†ì„±ì„ ì •ì˜í•œ í´ë˜ìŠ¤ë¥¼ ë§Œë“ ë‹¤.
ì¶”ê°€ì ìœ¼ë¡œ Validated ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•´ì„œ ê²€ì¦ë„ í•œë²ˆì— ê°€ëŠ¥í•˜ë‹¤!</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Component</span>
<span class="nd">@ConfigurationProperties</span><span class="o">(</span><span class="n">prefix</span> <span class="o">=</span> <span class="s">"taco.orders"</span><span class="o">)</span>
<span class="nd">@Data</span>
<span class="nd">@Validated</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">OrderProps</span> <span class="o">{</span>
    
    <span class="nd">@Min</span><span class="o">(</span><span class="n">value</span><span class="o">=</span><span class="mi">5</span><span class="o">,</span> <span class="n">message</span><span class="o">=</span><span class="s">"must be between 5 and 25"</span><span class="o">)</span>
    <span class="nd">@Max</span><span class="o">(</span><span class="n">value</span><span class="o">=</span><span class="mi">25</span><span class="o">,</span> <span class="n">message</span><span class="o">=</span><span class="s">"must be between 5 and 25"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">pageSize</span> <span class="o">=</span> <span class="mi">20</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<p>ì´ ë¹ˆì„ Controllerì— ì£¼ì…í•œë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/orders"</span><span class="o">)</span>
<span class="nd">@SessionAttributes</span><span class="o">(</span><span class="s">"order"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">OrderController</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="nc">OrderRepository</span> <span class="n">orderRepo</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">OrderProps</span> <span class="n">props</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">OrderController</span><span class="o">(</span><span class="nc">OrderRepository</span> <span class="n">orderRepo</span><span class="o">,</span> <span class="nc">OrderProps</span> <span class="n">props</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">orderRepo</span> <span class="o">=</span> <span class="n">orderRepo</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">props</span> <span class="o">=</span> <span class="n">props</span><span class="o">;</span>
    <span class="o">}</span>
	<span class="o">...</span>
	<span class="nd">@GetMapping</span>
	<span class="kd">public</span> <span class="nc">String</span> <span class="nf">ordersForUser</span><span class="o">(</span><span class="nd">@AuthenticationPrincipal</span> <span class="nc">User</span> <span class="n">user</span><span class="o">,</span> <span class="nc">Model</span> <span class="n">model</span><span class="o">){</span>
    	<span class="nc">Pageable</span> <span class="n">pageable</span> <span class="o">=</span> <span class="nc">PageRequest</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">props</span><span class="o">.</span><span class="na">getPageSize</span><span class="o">());</span>			<span class="c1">// í•˜ë“œì½”ë”© X</span>
		<span class="o">...</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>ê·¸ë˜ì„œ ì €ë ‡ê²Œ Props ë¶€ë¶„ì— ê³µí†µ ì†ì„±ë“¤ì„ ë‹¤ ë„£ì„ ìˆ˜ ìˆë‹¤!!</p>

<p>(ì‹ ê¸°!)</p>

<p>êµ¬ì„± ì†ì„± ë©”íƒ€ë°ì´í„° ì„ ì–¸</p>

<p>yml íŒŒì¼ì˜ taco: ë¶€ë¶„ì—ì„œ tacoë¥¼ ì¸ì‹í•˜ì§€ ëª»í•˜ë©´</p>

<p>í•´ë‹¹ ì†ì„±ì— ê´€í•œ ë©”íƒ€ë°ì´í„°ë¥¼ ìƒì„±í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="n">dependency</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">groupId</span><span class="o">&gt;</span><span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">boot</span><span class="o">&lt;/</span><span class="n">groupId</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">artifactId</span><span class="o">&gt;</span><span class="n">spring</span><span class="o">-</span><span class="n">boot</span><span class="o">-</span><span class="n">configuration</span><span class="o">-</span><span class="n">processor</span><span class="o">&lt;/</span><span class="n">artifactId</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">dependency</span><span class="o">&gt;</span>
</code></pre></div></div>
<p>í•´ë‹¹ ì˜ì¡´ì„±ì„ ìš°ì„  ì¶”ê°€í•´ì¤€ë‹¤.</p>

<p>spring-boot-configuration-processorëŠ” @ConfigurationProperties ì–´ë…¸í…Œì´ì…˜ì´ ì§€ì •ëœ ì• í”Œë¦¬ì¼€ì´ì…˜ í´ë˜ìŠ¤ì— ê´€í•œ ë©”íƒ€ë°ì´í„°ë¥¼ ìƒì„±í•˜ëŠ” ì–´ë…¸í…Œì´ì…˜ ì²˜ë¦¬ê¸°ì´ë‹¤.</p>

<p>ìƒì„±ëœ ë©”íƒ€ë°ì´í„°ëŠ” yml íŒŒì¼ì—ì„œ ìë™ì™„ì„± ê¸°ëŠ¥ì„ ì œê³µí•˜ê³  ì†ì„±ì˜ ë¬¸ì„œë¥¼ ë³´ì—¬ì£¼ê¸° ìœ„í•´ ì‚¬ìš©ëœë‹¤.</p>

<p>ì»¤ìŠ¤í…€ êµ¬ì„± ì†ì„±ì— ê´€í•œ ë©”íƒ€ë°ì´í„°ë¥¼ ìƒì„±í•˜ë ¤ë©´ json íŒŒì¼ì„ ìƒì„±í•˜ë„ë¡ í•œë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// additional-spring-configuration-metadata.json</span>
<span class="o">{</span>
  <span class="s">"properties"</span><span class="o">:</span> <span class="o">[{</span>
    <span class="s">"name"</span><span class="o">:</span> <span class="s">"taco.orders.page-size"</span><span class="o">,</span>
    <span class="s">"type"</span><span class="o">:</span> <span class="s">"int"</span><span class="o">,</span>
    <span class="s">"description"</span><span class="o">:</span> <span class="s">"Sets the maximum number of orders to display in a list"</span>
  <span class="o">}]</span>
<span class="o">}</span>
</code></pre></div></div>

<ul>
  <li>yml Profile</li>
</ul>

<p>ë¹ˆì— ë”°ë¥¸ í™œì„±í™”ê°€ í•„ìš”í•  ë•ŒëŠ” @Profileì„ ì‚¬ìš©í•œë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Bean</span>
<span class="nd">@Profile</span><span class="o">({</span><span class="s">"dev"</span><span class="o">,</span> <span class="err">"</span><span class="n">qa</span><span class="o">})</span>
<span class="kd">public</span> <span class="nc">CommandLineRunner</span> <span class="nf">dataLoader</span><span class="o">(){</span> <span class="o">...</span> <span class="o">}</span>
</code></pre></div></div>

<p>Chapter6 REST ì„œë¹„ìŠ¤</p>

<p>ì§€ê¸ˆê¹Œì§€ í•œ ë¶€ë¶„ì€ ìŠ¤í”„ë§ MVCë¥¼ í™œìš©í•´ì„œ MPA(Multi Page Application)ì„ ì‚¬ìš©í–ˆë‹¤.</p>

<p>ì´ì œëŠ” SPA(Single Page Application)ë¡œ í”„ë¡ íŠ¸ì—”ë“œë¥¼ êµ¬ì¶•í•  ê²ƒì´ë¼ê³  í•œë‹¤.</p>


        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/#java" class="page__taxonomy-item p-category" rel="tag">java</a><span class="sep">, </span>
    
      <a href="/tags/#spring" class="page__taxonomy-item p-category" rel="tag">spring</a><span class="sep">, </span>
    
      <a href="/tags/#%EC%8A%A4%ED%94%84%EB%A7%81%EC%9D%B8%EC%95%A1%EC%85%98" class="page__taxonomy-item p-category" rel="tag">ìŠ¤í”„ë§ì¸ì•¡ì…˜</a>
    
    </span>
  </p>




  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      <a href="/categories/#spring" class="page__taxonomy-item p-category" rel="tag">Spring</a>
    
    </span>
  </p>


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time class="dt-published" datetime="2021-10-18T00:00:00+09:00">October 18, 2021</time></p>

      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=%5B%EC%8A%A4%ED%94%84%EB%A7%81+%EC%9D%B8+%EC%95%A1%EC%85%985%5D+Chapter4~6+%EB%82%B4%EC%9A%A9+%EC%A0%95%EB%A6%AC%20http%3A%2F%2Flocalhost%3A4000%2Fspring%2FTIL-sia2%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2Fspring%2FTIL-sia2%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2Fspring%2FTIL-sia2%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/spring/TIL-sia1/" class="pagination--pager" title="[ìŠ¤í”„ë§ ì¸ ì•¡ì…˜5] Chapter1~3 ë‚´ìš© ì •ë¦¬
">Previous</a>
    
    
      <a href="/spring/TIL-ts1/" class="pagination--pager" title="[í† ë¹„ì˜ ìŠ¤í”„ë§] ì •ë¦¬
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h2 class="page__related-title">You may also enjoy</h2>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/java/JavaStudy-1-Array/" rel="permalink">[Java]ìë°”ì˜ ì •ì„ Chapter5-6
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i> January 04 2022</p>
    
    <!-- 

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          6 minute read
        
      </span>
    
  </p>

 -->
    <p class="archive__item-excerpt" itemprop="description">[Java]ìë°”ì˜ ì •ì„ Chapter5-6
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/spring/testcode1/" rel="permalink">í…ŒìŠ¤íŠ¸ì½”ë“œì˜ Mock, MockBean, Autowired, Spy ì´í•´í•˜ê¸°
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i> December 26 2021</p>
    
    <!-- 

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          1 minute read
        
      </span>
    
  </p>

 -->
    <p class="archive__item-excerpt" itemprop="description">Test code
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/spring/springmvc1/" rel="permalink">ìŠ¤í”„ë§ mvc 1í¸ ì •ë¦¬
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i> December 23 2021</p>
    
    <!-- 

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          5 minute read
        
      </span>
    
  </p>

 -->
    <p class="archive__item-excerpt" itemprop="description">ìŠ¤í”„ë§ mvc 1í¸ì„ ë“£ê³  ì •ë¦¬í•œ ë‚´ìš©ì…ë‹ˆë‹¤.
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/spring/TIL-ts1/" rel="permalink">[í† ë¹„ì˜ ìŠ¤í”„ë§] ì •ë¦¬
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i> November 01 2021</p>
    
    <!-- 

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          7 minute read
        
      </span>
    
  </p>

 -->
    <p class="archive__item-excerpt" itemprop="description">í† ë¹„ì˜ ìŠ¤í”„ë§ 2ì°¨ ì •ë¦¬
</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>
    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
          <li><a href="https://github.com/h3yon" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2022 h3yon Developer. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>







    
  <script>
    var disqus_config = function () {
      this.page.url = "http://localhost:4000/spring/TIL-sia2/";  /* Replace PAGE_URL with your page's canonical URL variable */
      this.page.identifier = "/spring/TIL-sia2"; /* Replace PAGE_IDENTIFIER with your page's unique identifier variable */
    };
    (function() { /* DON'T EDIT BELOW THIS LINE */
      var d = document, s = d.createElement('script');
      s.src = 'https://h3yon-github-io.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


  





  </body>
</html>
